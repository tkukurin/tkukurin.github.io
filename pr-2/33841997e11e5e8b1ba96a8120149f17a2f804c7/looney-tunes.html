<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.2.0
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  

  
    <title>Autonomous navigation of stratospheric looney tunes using RL</title>
    <meta name="description" content="Nature article by Google Brain and Loon. The problem they are solving is stratospheric superpressure baloon navigation. Balloons can navigate vertically by p...">
    <link rel="canonical" href="https://tkukurin.github.io/looney-tunes">
  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/skins/light.css">
  <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

</head>


  <body class="layout--post  autonomous-navigation-of-stratospheric-looney-tunes-using-rl">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

    <header class="masthead">
  <div class="wrap">
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">~</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description">caveat emptor</p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article class="h-entry">
    

    <div class="page-wrapper">
      <div class="page-sidebar">
        
            
            <h1 id="page-title" class="page-title p-name">Autonomous navigation of stratospheric looney tunes using RL
</h1>
        
        <div class="page-author h-card p-author"><div class="author-info">
    <time class="page-date dt-published" datetime="2020-12-06T00:00:00+00:00"><a class="u-url" href="">Dec 6, 2020</a>
</time>

  </div>
</div>

        

        
  <h3 class="page-taxonomies-title">Tags</h3>
  <ul class="page-taxonomies"><li class="page-taxonomy">rl</li><li class="page-taxonomy">research</li>
  </ul>


      </div>

      <div class="page-content">
        <div class="e-content">
          <p><a href="https://www.nature.com/articles/s41586-020-2939-8?fbclid=IwAR2BtsAuFw3GyKj-lhASiQCZmw_EZns1PmsiJNaAa3q9qMJjMJN3OqnZ83Y">Nature article by Google Brain and Loon</a>.
The problem they are solving is stratospheric superpressure baloon navigation.
Balloons can navigate vertically by pumping air, while horizontal motion is
achieved by wind currents. RL model is in production at Loon (update:
I guess <a href="https://spacenews.com/google-to-shut-down-loon/">not anymore</a> :().</p>

<p>Balloons should be maintained within 50km of a given <em>station</em>.
Problems: partial observability (sparse wind measurements), errors in prediction
(short-term forecasts vs actual measurements), battery-movement tradeoff.</p>

<p>Actions: ascend, descend, stay.
Reward: 1 if within 50km of station.
Long-term objective from starting state \(s\):</p>

\[R_s = \mathbb E \left [ \sum_{t=0}^\infty \gamma^t r(s_t,a_t)|s_0=s \right ]\]

<p>They use some soft decay the further this balloon is from its station.
Also have an additional component mixed in for power efficiency.</p>

<h2 id="dataset-augmentation-simulation">Dataset, augmentation, simulation</h2>

<p><strong>Gaussian Processes</strong> (GPs) to blend European Centre for Medium-Range Weather
Forecast (ECMWF, used as prior mean) weather data with balloon’s measurements.</p>

<p>Their ~10 years of data are inadequate for large deviations in behavior. Thus
construct <em>plausible</em> wind data from ECMWF’s ERA5 global reanalysis datset -
which reinterprets weather using numerical models, whatever that means.</p>

<h2 id="model">Model</h2>

<p>Wind is always centered around the balloon’s altitude (i.e. relative, not
absolute coordinates). Uncertainty incorporated in input.</p>

<p>7-layer, 600-unit ReLU NN, learned using a <a href="https://arxiv.org/pdf/1710.10044.pdf">Quantile Regression DQN</a>
(QR-DQN, also cf. some <a href="https://github.com/BY571/QR-DQN/blob/master/QR-DQN.ipynb">PyTorch reimplementation</a>).
In QR-DQN, the distribution over returns is modeled explicitly instead of only
estimating the mean.</p>

<h2 id="deployment">Deployment</h2>

<blockquote>
  <p>Real conditions differ due to modelling discrepancies in flight dynamics and
power consumption, making this experiment a major challenge for RL.</p>
</blockquote>

<p>Offloading the training offline seems to have helped (longer decision-making
horizon, lower computational cost). IRL performs better than eval, because eval
contains an artificially high proportion of difficult conditions. They don’t
mention how well it performs IRL difficult conditions.</p>

<p>Outside range (50-100km) spends more energy (55W vs 39W) to more quickly (3.3h
vs 5.0h) return within range (50km). In range spends less energy (29W vs 33W) to
stay in range a longer time (79% vs. 72%).</p>

<p>In between bouts of cognition, scripted behaviors and engineers take over from
the agent to reset the system to its initial configuration.</p>


        </div>

        

        

        <nav class="page-pagination" role="navigation">
  
    <a class="page-previous" href="/levels-of-bio-plausibility">
      <h4 class="page-pagination-label">Previous</h4>
      <span class="page-pagination-title">
        <i class="fas fa-arrow-left"></i> Levels of biological plausibility

      </span>
    </a>
  

  
    <a class="page-next" href="/go-explore">
      <h4 class="page-pagination-label">Next</h4>
      <span class="page-pagination-title">
        Go Explore
 <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  
</nav>

      </div>
    </div>
  </article>
</main>

    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="social-icons"><a class="social-icon" href="https://twitter.com/tkukurin"><i class="fab fa-twitter-square fa-2x" title="Twitter"></i></a><a class="social-icon" href="https://github.com/tkukurin"><i class="fab fa-github-square fa-2x" title="GitHub"></i></a><a class="social-icon" href="https://www.linkedin.com/in/toni/"><i class="fab fa-linkedin fa-2x" title="LinkedIn"></i></a></div><div class="copyright">
    
      

    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>


<!-- MathJax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  </body>

</html>
